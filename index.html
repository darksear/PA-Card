<!DOCTYPE HTML>

<html>
<head>
<link rel="stylesheet" type="text/css" href="CSS/style.css">
<script src="JS/dist/jspdf.debug.js"></script>
<meta charset="utf-8">
</head>
<body>
	<!--Creating inputs-->
	<input type="text" id="year">
	<input type="text" id="total">
	<input type="checkbox" id="home">
	<input type="checkbox" id="store">
	<button type="button" id="print">Print</button>
	<div id="instructions">Please enter the year and the PA amount in their respective boxes and then click on the In-Home or Carry-In checkboxes. <div>When you are ready to print the card click on Print. Click on refresh when you want to print another.</div></div>
	<!--Initializing the canvas.-->
	<canvas id="c" width="400" height="500"></canvas>
	<script>
		//creating variables
		var c = document.querySelector("#c");
		var ctx = c.getContext("2d");
		var yearsChange = document.getElementById("year");
		var totalsChange = document.getElementById("total");
		var homeChecked = document.getElementById("home");
		var storeChecked = document.getElementById("store");
		var printButton = document.getElementById("print");
		var instructionsChange = document.getElementById("instructions");
		var years = document.getElementById("year").value;
		var totals = document.getElementById("total").value;
		var maths = totals / (years * 12);
		var imageToPrint = document.getElementById('c');
		var printImage = imageToPrint.toDataURL("image/jpeg", 1.0);
		var pdf = new jsPDF('p','in',[4, 5]);

		//adding Listener Events
		printButton.addEventListener("click", printClick, true);
		homeChecked.addEventListener("click", homeChange, true);
		storeChecked.addEventListener("click", storeChange, true);
		yearsChange.addEventListener("change", onChanges, true);
		totalsChange.addEventListener("change", onChanges, true);

		//removes check from home checkbox when store checkbox is clicked
		function homeChange() {
			document.getElementById("store").checked = false;
			onChanges();
		}

		//removes check from store checkbox when home checkbox is clicked
		function storeChange() {
			document.getElementById("home").checked = false;
			onChanges();
		}

		//clears the previous monthly pa and calculates and displays a new one
		function onChanges() {
			years = document.getElementById("year").value;
			totals = document.getElementById("total").value;
			if (years !== null ) {
				ctx.clearRect(100, 175, 300, 50);
				maths = (totals / (years * 12));
				ctx.font = "30px Arial";
				ctx.fillText(maths.toFixed(2) + " A Month", 100, 210);
			}
		}

		//removes all buttons and background images displays a printer friendly screen and opens the print dialog.
		function printClick() {
			c.style.backgroundImage = "url('Images/blank.jpg')";
			ctx.clearRect(0, 0, 400, 500);
			ctx.font= "30px Arial";
			ctx.fillText(maths.toFixed(2) + " A Month", 100, 110);

			ctx.font= "80px Arial";
			ctx.fillText(years, 175, 210);

			ctx.font= "900 30px Arial";
			if (homeChecked.checked == true) {
				ctx.fillText("✓", 22, 293);
			}
			else if(storeChecked.checked == true) {
				ctx.fillText("✓", 210, 295);
			}

			ctx.font= "12px Arial";
			ctx.fillText(totals, 325, 325);
			printButton.style.display ="none";
			homeChecked.style.display = "none";
			storeChecked.style.display = "none";
			totalsChange.style.display = "none";
			yearsChange.style.display = "none";
			instructionsChange.style.display = "none";
			pdf.addHTML(document.c, function() {
				pdf.save('print.pdf');
			});
		}
	</script>
</body>
</html>